<!doctype html>
<html lang="eu">
<head>
<meta charset="utf-8">
<title>Konposatu Inorganikoak</title>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="theme-color" content="#f1f8e9">
<style>
:root{
  --bg:#f1f8e9;
  --card:#fff;
  --accent:#7a9c89;
  --accent-dark:#5a7b68;
  --text:#2c3e50;
  --soft:#7f8c8d;
}
*{box-sizing:border-box;margin:0;padding:0;font-family:'Segoe UI',Roboto,system-ui}
body{display:flex;flex-direction:column;height:100vh;background:var(--bg);color:var(--text)}
header{
  position:sticky;top:0;z-index:10;display:flex;align-items:center;padding:12px 16px;
  background:var(--card);box-shadow:0 2px 4px rgba(0,0,0,.08);height:56px}
#search{
  flex:1;border:1px solid #d0e0d7;border-radius:24px;padding:8px 14px;font-size:16px}
#counter{
  margin-left:12px;width:30px;height:30px;border-radius:50%;background:var(--accent);
  color:#fff;display:grid;place-items:center;font-weight:bold}
#results-wrapper{
  flex:1;overflow-y:auto;padding:16px 12px 24px}   /* espacio extra arriba y abajo */
#results{padding-top:4px}   /* peque√±o ajuste fino */
.compound-card{
  background:var(--card);border:1px solid #d0e0d7;border-radius:12px;padding:12px;margin-bottom:8px}
.compound-name{font-weight:600;margin-bottom:4px}
.compound-type{font-size:12px;color:var(--soft)}
.no-results{color:var(--soft);text-align:center;margin-top:24px}
#selector{
  position:fixed;inset:0;background:#0009;display:none;flex-direction:column;
  padding:12px;background:#00000066}
#selector ul{background:var(--card);border-radius:12px;max-height:60vh;overflow-y:auto}
#selector li{
  display:flex;align-items:center;padding:12px;border-bottom:1px solid #e0e6e1}
#selector li:last-child{border:none}
#selector input{margin-right:12px}
#selector button{margin-top:12px;width:100%}
button{
  border:none;padding:12px;border-radius:24px;background:var(--accent);color:#fff;font-weight:bold}
.metal{background:#e8f5e9}
.nonmetal{background:#f5f5f5}
#reopen{
  position:fixed;bottom:20px;right:20px;width:52px;height:52px;border-radius:50%;
  background:var(--accent);color:#fff;font-size:24px;border:none;box-shadow:0 4px 12px rgba(0,0,0,.25);
  display:none;place-items:center}
</style>
</head>
<body>

<header>
  <input id="search" placeholder="Elementuak bilatu..." autocomplete="off">
  <div id="counter">0</div>
</header>

<div id="results-wrapper">
  <div id="results"></div>
</div>

<div id="selector">
  <ul id="opts"></ul>
  <button onclick="closeSel()">Itxi</button>
</div>

<button id="reopen" onclick="reopenKeyboard()">üîç</button>

<script>
const names={
  H:"Hidrogeno",O:"Oxigeno",F:"Fluor",Cl:"Kloro",Br:"Bromo",I:"Iodo",
  S:"Sufre",Se:"Selenio",Te:"Telurio",N:"Nitrogeno",P:"Fosforo",As:"Artseniko",Sb:"Antimonio",
  C:"Karbono",Si:"Silizio",B:"Boro",
  Li:"Litio",Na:"Sodio",K:"Potasio",Rb:"Rubidio",Cs:"Zesio",Fr:"Frantzio",Ag:"Zilar",
  Be:"Berilio",Mg:"Magnesio",Ca:"Kaltzio",Sr:"Estrontzio",Ba:"Bario",Ra:"Radio",Zn:"Zink",Cd:"Kadmio",
  Cu:"Kobre",Hg:"Merkurio",Au:"Urrea",Fe:"Burdina",Co:"Kobalto",Ni:"Nikel",Cr:"Kromo",Mn:"Manganeso",Al:"Aluminio",
  Sn:"Eztainu",Pb:"Beruna",Bi:"Bismuto"
};
const db={
  oxidoa:[
    {f:"H‚ÇÇO",n:"Ura",e:["H","O"]},{f:"Li‚ÇÇO",n:"Litio oxidoa",e:["Li","O"]},
    {f:"Na‚ÇÇO",n:"Sodio oxidoa",e:["Na","O"]},{f:"K‚ÇÇO",n:"Potasio oxidoa",e:["K","O"]},
    {f:"MgO",n:"Magnesio oxidoa",e:["Mg","O"]},{f:"CaO",n:"Kaltzio oxidoa",e:["Ca","O"]},
    {f:"Al‚ÇÇO‚ÇÉ",n:"Aluminio oxidoa",e:["Al","O"]},{f:"CO",n:"Karbono(II) oxidoa",e:["C","O"]},
    {f:"CO‚ÇÇ",n:"Karbono(IV) oxidoa",e:["C","O"]},{f:"SO‚ÇÇ",n:"Sufre(IV) oxidoa",e:["S","O"]},
    {f:"SO‚ÇÉ",n:"Sufre(VI) oxidoa",e:["S","O"]},{f:"NO",n:"Nitrogeno(II) oxidoa",e:["N","O"]},
    {f:"NO‚ÇÇ",n:"Nitrogeno(IV) oxidoa",e:["N","O"]},{f:"CuO",n:"Kobre(II) oxidoa",e:["Cu","O"]},
    {f:"FeO",n:"Burdin(II) oxidoa",e:["Fe","O"]},{f:"Fe‚ÇÇO‚ÇÉ",n:"Burdin(III) oxidoa",e:["Fe","O"]}
  ],
  gatz:[
    {f:"NaCl",n:"Sodio kloruroa",e:["Na","Cl"]},{f:"KCl",n:"Potasio kloruroa",e:["K","Cl"]},
    {f:"MgCl‚ÇÇ",n:"Magnesio kloruroa",e:["Mg","Cl"]},{f:"CaCl‚ÇÇ",n:"Kaltzio kloruroa",e:["Ca","Cl"]},
    {f:"CuCl",n:"Kobre(I) kloruroa",e:["Cu","Cl"]},{f:"CuCl‚ÇÇ",n:"Kobre(II) kloruroa",e:["Cu","Cl"]},
    {f:"AgCl",n:"Zilar kloruroa",e:["Ag","Cl"]},{f:"FeCl‚ÇÇ",n:"Burdin(II) kloruroa",e:["Fe","Cl"]},
    {f:"FeCl‚ÇÉ",n:"Burdin(III) kloruroa",e:["Fe","Cl"]},{f:"AlCl‚ÇÉ",n:"Aluminio kloruroa",e:["Al","Cl"]},
    {f:"NaF",n:"Sodio fluoruroa",e:["Na","F"]},{f:"NaBr",n:"Sodio bromuroa",e:["Na","Br"]},
    {f:"NaI",n:"Sodio yoduroa",e:["Na","I"]}
  ],
  hidrox:[
    {f:"NaOH",n:"Sodio hidroxidoa",e:["Na","O","H"]},{f:"KOH",n:"Potasio hidroxidoa",e:["K","O","H"]},
    {f:"Ca(OH)‚ÇÇ",n:"Kaltzio hidroxidoa",e:["Ca","O","H"]},{f:"Al(OH)‚ÇÉ",n:"Aluminio hidroxidoa",e:["Al","O","H"]}
  ],
  azid:[
    {f:"HCl",n:"Azido klorhidrikoa",e:["H","Cl"]},{f:"H‚ÇÇSO‚ÇÑ",n:"Azido sulfurikoa",e:["H","S","O"]},
    {f:"HNO‚ÇÉ",n:"Azido nitrikoa",e:["H","N","O"]},{f:"H‚ÇÇCO‚ÇÉ",n:"Azido karbonikoa",e:["H","C","O"]},
    {f:"H‚ÇÉPO‚ÇÑ",n:"Azido fosforikoa",e:["H","P","O"]}
  ]
};

let selected={};
const max=3;
const search=document.getElementById('search');
const counter=document.getElementById('counter');
const res=document.getElementById('results');
const reopen=document.getElementById('reopen');
const wrapper=document.getElementById('results-wrapper');

search.addEventListener('focus',openSel);
search.addEventListener('input',e=>fillOpts(e.target.value));

function openSel(){
  reopen.style.display='none';
  document.getElementById('selector').style.display='flex';
  fillOpts('');
}
function closeSel(){
  document.getElementById('selector').style.display='none';
  search.value='';
  reopen.style.display='grid';
}
function reopenKeyboard(){
  reopen.style.display='none';
  search.focus();
}
function fillOpts(q){
  const ul=document.getElementById('opts');ul.innerHTML='';
  const norm=q.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");
  ['H','O'].forEach(s=>{
    if(q===''||names[s].toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(norm)||s.toLowerCase().includes(norm)){
      ul.appendChild(createLi(s));
    }
  });
  Object.keys(names).filter(s=>!['H','O'].includes(s)).forEach(s=>{
    if(q===''||names[s].toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(norm)||s.toLowerCase().includes(norm)){
      ul.appendChild(createLi(s));
    }
  });
}
function createLi(s){
  const li=document.createElement('li');
  li.className= ['Li','Na','K','Rb','Cs','Fr','Ag','Be','Mg','Ca','Sr','Ba','Ra','Zn','Cd','Cu','Hg','Au','Fe','Co','Ni','Cr','Mn','Al','Sn','Pb','Bi'].includes(s)?'metal':'nonmetal';
  const chk=document.createElement('input');chk.type='checkbox';
  chk.checked=!!selected[s];
  chk.onchange=()=>toggleList(s);
  li.appendChild(chk);
  li.appendChild(document.createTextNode(`${names[s]} (${s})`));
  return li;
}
function toggleList(sym){
  const n=(selected[sym]||0)+1;
  if(n>max){delete selected[sym]}
  else{if(!selected[sym]&&Object.keys(selected).length>=max){return}
       selected[sym]=n}
  fillOpts(search.value);
  updateCounter();
}
function updateCounter(){
  counter.textContent=Object.keys(selected).length;
  calc();
}
function calc(){
  const pick=Object.keys(selected);
  let html='<h2>Konposatuak</h2>';
  let found=0;
  Object.entries(db).forEach(([typ,arr])=>{
    arr.forEach(c=>{
      if(c.e.every(x=>pick.includes(x))){found++;html+=`<div class="compound-card"><div class="compound-name">${c.f} ‚Äì ${c.n}</div><div class="compound-type">${typ}</div></div>`}
    });
  });
  if(!found)html+='<div class="no-results">Ez da aurkitu.</div>';
  res.innerHTML=html;
  wrapper.scrollTop=0;   /* <<< clave: siempre visible el primer compuesto */
}
calc();
</script>
</body>
</html>
